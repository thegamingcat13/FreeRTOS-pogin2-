<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="nl">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FreeRTOS_GPS_407: Core/MyApp/App/ledjes.c Bestand Referentie</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FreeRTOS_GPS_407
   </div>
   <div id="projectbrief">Cursusmateriaal C-programmeren met RTOS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Gegenereerd door Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Zoeken');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Laden...</div>
<div class="SRStatus" id="Searching">Zoeken...</div>
<div class="SRStatus" id="NoMatches">Niets gevonden</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_c6310732a22f63c0c2fc5595561e68f1.html">Core</a></li><li class="navelem"><a class="el" href="dir_57032f474d1dbb45fddb3707c23dae53.html">MyApp</a></li><li class="navelem"><a class="el" href="dir_33625ee3d03525a7783dfd3fc9901b4f.html">App</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functies</a> &#124;
<a href="#var-members">Variabelen</a>  </div>
  <div class="headertitle"><div class="title">ledjes.c Bestand Referentie</div></div>
</div><!--header-->
<div class="contents">

<p>Laat de werking van mutexes en tasknotification zien.<br  />
 <b>Demonstreert: , xSemaphoreTake(), xSemaphoreGive(), xTaskNotifyGive(), ulTaskNotifyTake(), taskYIELD().</b><br  />
  
<a href="#details">Meer...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="admin_8h_source.html">admin.h</a>&gt;</code><br />
<code>#include &quot;main.h&quot;</code><br />
<code>#include &quot;cmsis_os.h&quot;</code><br />
</div>
<p><a href="ledjes_8c_source.html">Ga naar de broncode van dit bestand.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functies</h2></td></tr>
<tr class="memitem:aaf63dace9f7f47a694f8950fbe086df3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ledjes_8c.html#aaf63dace9f7f47a694f8950fbe086df3">LED_Task1</a> (void *argument)</td></tr>
<tr class="memdesc:aaf63dace9f7f47a694f8950fbe086df3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores.  <br /></td></tr>
<tr class="separator:aaf63dace9f7f47a694f8950fbe086df3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a827d2f52992b1ba443aabe4ee4cbc89d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ledjes_8c.html#a827d2f52992b1ba443aabe4ee4cbc89d">LED_Task2</a> (void *argument)</td></tr>
<tr class="memdesc:a827d2f52992b1ba443aabe4ee4cbc89d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores.  <br /></td></tr>
<tr class="separator:a827d2f52992b1ba443aabe4ee4cbc89d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad23f4088808e5ccc47e28a69fdf155e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ledjes_8c.html#ad23f4088808e5ccc47e28a69fdf155e6">LED_Task3</a> (void *argument)</td></tr>
<tr class="memdesc:ad23f4088808e5ccc47e28a69fdf155e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores. Task 3 en 4 werken daarnaast nog met tasknotification.  <br /></td></tr>
<tr class="separator:ad23f4088808e5ccc47e28a69fdf155e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46ab630af9d7344d8968a7874ec71578"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ledjes_8c.html#a46ab630af9d7344d8968a7874ec71578">LED_Task4</a> (void *argument)</td></tr>
<tr class="memdesc:a46ab630af9d7344d8968a7874ec71578"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores. Task 3 en 4 werken daarnaast nog met tasknotification.  <br /></td></tr>
<tr class="separator:a46ab630af9d7344d8968a7874ec71578"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variabelen</h2></td></tr>
<tr class="memitem:ac0e8ff7c2f49b0988165336ca423dcea"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ledjes_8c.html#ac0e8ff7c2f49b0988165336ca423dcea">os_delay</a> = 100</td></tr>
<tr class="memdesc:ac0e8ff7c2f49b0988165336ca423dcea"><td class="mdescLeft">&#160;</td><td class="mdescRight">default value 100MSEC, kan veranderd worden via Terminal (user interface)  <br /></td></tr>
<tr class="separator:ac0e8ff7c2f49b0988165336ca423dcea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Gedetailleerde Beschrijving</h2>
<div class="textblock"><p>Laat de werking van mutexes en tasknotification zien.<br  />
 <b>Demonstreert: , xSemaphoreTake(), xSemaphoreGive(), xTaskNotifyGive(), ulTaskNotifyTake(), taskYIELD().</b><br  />
 </p>
<p><a class="el" href="ledjes_8c.html#aaf63dace9f7f47a694f8950fbe086df3" title="Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores.">LED_Task1()</a>, <a class="el" href="ledjes_8c.html#a827d2f52992b1ba443aabe4ee4cbc89d" title="Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores.">LED_Task2()</a>, <a class="el" href="ledjes_8c.html#ad23f4088808e5ccc47e28a69fdf155e6" title="Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores....">LED_Task3()</a> en <a class="el" href="ledjes_8c.html#a46ab630af9d7344d8968a7874ec71578" title="Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores....">LED_Task4()</a> tonen het mutual exclusion semaphore principe. <br  />
 Allemaal zetten ze de LEDs op een bepaalde manier aan en uit. <em>Doordat ze een semaphore gebruiken kunnen ze allemaal hun eigen loepje afmaken, zonder dat ze door een context switch onderbroken worden</em>. De semaphore zorgt ervoor dat ze steeds even zelf eigenaar zijn van de LEDs, en zolang ze de semaphore bezitten worden andere taken uitgesloten (hence: <em>Mutual Exclusion Semaphore</em>). Ze krijgen dan pas de beurt als de task die de mutex bezit, deze vrijgeeft (met semaphoregive). LED_tasks 1 en 2 werken met het Round Robin principe. Dat kan door ze dezelfde prioriteit te geven.<br  />
</p>
<p>Stel, je wilt dat niet, dan moet je iets anders verzinnen, zie <a class="el" href="ledjes_8c.html#ad23f4088808e5ccc47e28a69fdf155e6" title="Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores....">LED_Task3()</a> en <a class="el" href="ledjes_8c.html#a46ab630af9d7344d8968a7874ec71578" title="Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores....">LED_Task4()</a>. Deze hebben een kleine toevoeging t.o.v. 1 en 2: Ze laten niet het OS bepalen wie aan de beurt is met Round Robin, maar bepalen het zelf met tasknotify! Ze geven steeds elkaar de beurt. Zo kun je werken met verschillende task-priorities, zonder dat tasks met een lage prioriteit 'starven', dus geen timeslices krijgen van het OS.<br  />
 Want: FreeRTOS bezit geen priority-inversion (uC//OSII bv. wel)! Daarbij gaat het OS een taak met een lage prioriteit die dreigt te 'starven', zelf ophogen zodat de taak wel aan de beurt komt.</p>
<dl class="section author"><dt>Auteur</dt><dd>MSC</dd></dl>
<dl class="section date"><dt>Datum</dt><dd>5/5/2022 </dd></dl>

<p class="definition">De definitie bevindt zich in het bestand <a class="el" href="ledjes_8c_source.html">ledjes.c</a>.</p>
</div><h2 class="groupheader">Documentatie van functies</h2>
<a id="aaf63dace9f7f47a694f8950fbe086df3" name="aaf63dace9f7f47a694f8950fbe086df3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf63dace9f7f47a694f8950fbe086df3">&#9670;&#160;</a></span>LED_Task1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LED_Task1 </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>argument</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*argument</td><td>Niet gebruikt, eventueel een waarde of string om te testen </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retourneert</dt><dd>void </dd></dl>

<p class="definition">De definitie bevindt zich op regel <a class="el" href="ledjes_8c_source.html#l00044">44</a> in het bestand <a class="el" href="ledjes_8c_source.html">ledjes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   45</span>{</div>
<div class="line"><span class="lineno">   46</span>    UART_puts((<span class="keywordtype">char</span> *)__func__); UART_puts(<span class="stringliteral">&quot; started\r\n&quot;</span>);</div>
<div class="line"><span class="lineno">   47</span>    <span class="keywordtype">int</span> i, leds;</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">while</span>(TRUE)</div>
<div class="line"><span class="lineno">   50</span>    {</div>
<div class="line"><span class="lineno">   51</span>        xSemaphoreTake(<a class="code hl_variable" href="admin_8c.html#a011b1349f4d8c02977b852c7587f0581">hLED_Sem</a>, portMAX_DELAY); <span class="comment">/* wacht op toegang tot de semaphore;</span></div>
<div class="line"><span class="lineno">   52</span><span class="comment">        * de code hieronder wordt alleen uitgevoerd nadat ik de mutex heb gekregen.</span></div>
<div class="line"><span class="lineno">   53</span><span class="comment">        * andere tasks die op deze mutex wachten, kunnen pas door nadat ik de mutex</span></div>
<div class="line"><span class="lineno">   54</span><span class="comment">        * heb vrijgegeven met Give.</span></div>
<div class="line"><span class="lineno">   55</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno">   56</span>        leds = 128; <span class="comment">// start at led nr. 8</span></div>
<div class="line"><span class="lineno">   57</span>        <span class="keywordflow">for</span> (i=0; i&lt;8; i++, leds&gt;&gt;=1)</div>
<div class="line"><span class="lineno">   58</span>        {</div>
<div class="line"><span class="lineno">   59</span>            LED_put(leds); <span class="comment">// set leds</span></div>
<div class="line"><span class="lineno">   60</span>            osDelay(<a class="code hl_variable" href="ledjes_8c.html#ac0e8ff7c2f49b0988165336ca423dcea">os_delay</a>);</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="admin_8c.html#a952449da34b356e2651de547daf4312c">Uart_debug_out</a> &amp; <a class="code hl_define" href="admin_8h.html#a367617a9804f8aeeb1b5b09d17af0d1a">LEDS_DEBUG_OUT</a>)</div>
<div class="line"><span class="lineno">   63</span>            {</div>
<div class="line"><span class="lineno">   64</span>                UART_puts(<span class="stringliteral">&quot;\r\nM1 led: &quot;</span>); UART_putint(leds);</div>
<div class="line"><span class="lineno">   65</span>            }</div>
<div class="line"><span class="lineno">   66</span>        }</div>
<div class="line"><span class="lineno">   67</span>        xSemaphoreGive(<a class="code hl_variable" href="admin_8c.html#a011b1349f4d8c02977b852c7587f0581">hLED_Sem</a>); <span class="comment">// geef de semaphore weer vrij voor een ander</span></div>
<div class="line"><span class="lineno">   68</span>        taskYIELD(); <span class="comment">// done, force context switch, otherwise freeRTOS stays in this task</span></div>
<div class="line"><span class="lineno">   69</span>    }</div>
<div class="line"><span class="lineno">   70</span>}</div>
<div class="ttc" id="aadmin_8c_html_a011b1349f4d8c02977b852c7587f0581"><div class="ttname"><a href="admin_8c.html#a011b1349f4d8c02977b852c7587f0581">hLED_Sem</a></div><div class="ttdeci">SemaphoreHandle_t hLED_Sem</div><div class="ttdoc">uses UART1</div><div class="ttdef"><b>Definitie</b> <a href="admin_8c_source.html#l00045">admin.c:45</a></div></div>
<div class="ttc" id="aadmin_8c_html_a952449da34b356e2651de547daf4312c"><div class="ttname"><a href="admin_8c.html#a952449da34b356e2651de547daf4312c">Uart_debug_out</a></div><div class="ttdeci">int Uart_debug_out</div><div class="ttdoc">default: debug all output to uart</div><div class="ttdef"><b>Definitie</b> <a href="admin_8c_source.html#l00038">admin.c:38</a></div></div>
<div class="ttc" id="aadmin_8h_html_a367617a9804f8aeeb1b5b09d17af0d1a"><div class="ttname"><a href="admin_8h.html#a367617a9804f8aeeb1b5b09d17af0d1a">LEDS_DEBUG_OUT</a></div><div class="ttdeci">#define LEDS_DEBUG_OUT</div><div class="ttdoc">bit 1: toggles leds stuff output</div><div class="ttdef"><b>Definitie</b> <a href="admin_8h_source.html#l00072">admin.h:72</a></div></div>
<div class="ttc" id="aledjes_8c_html_ac0e8ff7c2f49b0988165336ca423dcea"><div class="ttname"><a href="ledjes_8c.html#ac0e8ff7c2f49b0988165336ca423dcea">os_delay</a></div><div class="ttdeci">unsigned int os_delay</div><div class="ttdoc">default value 100MSEC, kan veranderd worden via Terminal (user interface)</div><div class="ttdef"><b>Definitie</b> <a href="ledjes_8c_source.html#l00036">ledjes.c:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a827d2f52992b1ba443aabe4ee4cbc89d" name="a827d2f52992b1ba443aabe4ee4cbc89d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a827d2f52992b1ba443aabe4ee4cbc89d">&#9670;&#160;</a></span>LED_Task2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LED_Task2 </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>argument</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*argument</td><td>Niet gebruikt, eventueel een waarde of string om te testen </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retourneert</dt><dd>void </dd></dl>

<p class="definition">De definitie bevindt zich op regel <a class="el" href="ledjes_8c_source.html#l00077">77</a> in het bestand <a class="el" href="ledjes_8c_source.html">ledjes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   78</span>{</div>
<div class="line"><span class="lineno">   79</span>    UART_puts((<span class="keywordtype">char</span> *)__func__); UART_puts(<span class="stringliteral">&quot; started\r\n&quot;</span>);</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordtype">int</span> i, leds;</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordflow">while</span>(TRUE)</div>
<div class="line"><span class="lineno">   83</span>    {</div>
<div class="line"><span class="lineno">   84</span>        xSemaphoreTake(<a class="code hl_variable" href="admin_8c.html#a011b1349f4d8c02977b852c7587f0581">hLED_Sem</a>, portMAX_DELAY); <span class="comment">// wait to enter</span></div>
<div class="line"><span class="lineno">   85</span>        leds = 1;</div>
<div class="line"><span class="lineno">   86</span>        <span class="keywordflow">for</span> (i=0; i&lt;8; i++, leds&lt;&lt;=1)</div>
<div class="line"><span class="lineno">   87</span>        {</div>
<div class="line"><span class="lineno">   88</span>            LED_put(leds); <span class="comment">// set leds</span></div>
<div class="line"><span class="lineno">   89</span>            osDelay(<a class="code hl_variable" href="ledjes_8c.html#ac0e8ff7c2f49b0988165336ca423dcea">os_delay</a>);</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="admin_8c.html#a952449da34b356e2651de547daf4312c">Uart_debug_out</a> &amp; <a class="code hl_define" href="admin_8h.html#a367617a9804f8aeeb1b5b09d17af0d1a">LEDS_DEBUG_OUT</a>)</div>
<div class="line"><span class="lineno">   92</span>            {</div>
<div class="line"><span class="lineno">   93</span>                UART_puts(<span class="stringliteral">&quot;\r\n\tM2 led: &quot;</span>); UART_putint(leds);</div>
<div class="line"><span class="lineno">   94</span>            }</div>
<div class="line"><span class="lineno">   95</span>        }</div>
<div class="line"><span class="lineno">   96</span>        xSemaphoreGive(<a class="code hl_variable" href="admin_8c.html#a011b1349f4d8c02977b852c7587f0581">hLED_Sem</a>); <span class="comment">// free mutex</span></div>
<div class="line"><span class="lineno">   97</span>        taskYIELD(); <span class="comment">// done, force context switch, otherwise freeRTOS stays in this task</span></div>
<div class="line"><span class="lineno">   98</span>    }</div>
<div class="line"><span class="lineno">   99</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad23f4088808e5ccc47e28a69fdf155e6" name="ad23f4088808e5ccc47e28a69fdf155e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad23f4088808e5ccc47e28a69fdf155e6">&#9670;&#160;</a></span>LED_Task3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LED_Task3 </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>argument</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores. Task 3 en 4 werken daarnaast nog met tasknotification. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*argument</td><td>Niet gebruikt, eventueel een waarde of string om te testen </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retourneert</dt><dd>void </dd></dl>

<p class="definition">De definitie bevindt zich op regel <a class="el" href="ledjes_8c_source.html#l00107">107</a> in het bestand <a class="el" href="ledjes_8c_source.html">ledjes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  108</span>{</div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordtype">int</span>          i, leds;</div>
<div class="line"><span class="lineno">  110</span>    osThreadId_t hTask4;</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">if</span> (!(hTask4 = xTaskGetHandle(<span class="stringliteral">&quot;LED_Task4&quot;</span>)))</div>
<div class="line"><span class="lineno">  113</span>       <a class="code hl_function" href="admin_8c.html#a34a9c5eb09cae80d85d5d13a348ee1e8">error_HaltOS</a>(<span class="stringliteral">&quot;Err:hTask4&quot;</span>);</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    UART_puts((<span class="keywordtype">char</span> *)__func__); UART_puts(<span class="stringliteral">&quot; started\r\n&quot;</span>);</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordflow">while</span>(TRUE)</div>
<div class="line"><span class="lineno">  118</span>    {</div>
<div class="line"><span class="lineno">  119</span>        xSemaphoreTake(<a class="code hl_variable" href="admin_8c.html#a011b1349f4d8c02977b852c7587f0581">hLED_Sem</a>, portMAX_DELAY); <span class="comment">// wait to get in...</span></div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>        <span class="keywordflow">for</span> (i=0; i&lt;4; i++) <span class="comment">// voorbeeld hoe je je code zo overdraagbaar mogelijk maakt</span></div>
<div class="line"><span class="lineno">  122</span>        {</div>
<div class="line"><span class="lineno">  123</span>            <span class="keywordflow">if</span>      (i==0)  leds = 8+16; <span class="comment">// zichtbaar: 1. waarde i, 2. welke leds aan gaan</span></div>
<div class="line"><span class="lineno">  124</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i==1)  leds = 4+32; <span class="comment">// ... had ook met switch-case gekund</span></div>
<div class="line"><span class="lineno">  125</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i==2)  leds = 2+64;</div>
<div class="line"><span class="lineno">  126</span>            <span class="keywordflow">else</span>            leds = 1+128;</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>            LED_put(leds);     <span class="comment">// set leds</span></div>
<div class="line"><span class="lineno">  129</span>            osDelay(<a class="code hl_variable" href="ledjes_8c.html#ac0e8ff7c2f49b0988165336ca423dcea">os_delay</a>); <span class="comment">// snelheid bepalen, kan veranderd worden via user interface</span></div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="admin_8c.html#a952449da34b356e2651de547daf4312c">Uart_debug_out</a> &amp; <a class="code hl_define" href="admin_8h.html#a367617a9804f8aeeb1b5b09d17af0d1a">LEDS_DEBUG_OUT</a>)</div>
<div class="line"><span class="lineno">  132</span>            {</div>
<div class="line"><span class="lineno">  133</span>                UART_puts(<span class="stringliteral">&quot;\r\n\t\tM3 led: &quot;</span>); UART_putint(leds);</div>
<div class="line"><span class="lineno">  134</span>            }</div>
<div class="line"><span class="lineno">  135</span>        }</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>        xSemaphoreGive(<a class="code hl_variable" href="admin_8c.html#a011b1349f4d8c02977b852c7587f0581">hLED_Sem</a>); <span class="comment">// free mutex</span></div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>        xTaskNotifyGive(hTask4); <span class="comment">// give the ball to mutextask4</span></div>
<div class="line"><span class="lineno">  140</span>        osDelay(200);</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>        ulTaskNotifyTake(pdTRUE, portMAX_DELAY); <span class="comment">// wait for task 4</span></div>
<div class="line"><span class="lineno">  143</span>    }</div>
<div class="line"><span class="lineno">  144</span>}</div>
<div class="ttc" id="aadmin_8c_html_a34a9c5eb09cae80d85d5d13a348ee1e8"><div class="ttname"><a href="admin_8c.html#a34a9c5eb09cae80d85d5d13a348ee1e8">error_HaltOS</a></div><div class="ttdeci">void error_HaltOS(char *msg)</div><div class="ttdoc">Fatale OS-error opgetreden tijdens startup of runtime, doorgaan is zinloos. Het OS wordt tot stoppen ...</div><div class="ttdef"><b>Definitie</b> <a href="admin_8c_source.html#l00191">admin.c:191</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a46ab630af9d7344d8968a7874ec71578" name="a46ab630af9d7344d8968a7874ec71578"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46ab630af9d7344d8968a7874ec71578">&#9670;&#160;</a></span>LED_Task4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LED_Task4 </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>argument</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tasks die ledjes manipuleren nadat ze eerst afgeschermd zijn met mutex semaphores. Task 3 en 4 werken daarnaast nog met tasknotification. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*argument</td><td>Niet gebruikt, eventueel een waarde of string om te testen </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Retourneert</dt><dd>void </dd></dl>

<p class="definition">De definitie bevindt zich op regel <a class="el" href="ledjes_8c_source.html#l00152">152</a> in het bestand <a class="el" href="ledjes_8c_source.html">ledjes.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  153</span>{</div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordtype">int</span>          i, leds;</div>
<div class="line"><span class="lineno">  155</span>    osThreadId_t hTask3;</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">if</span> (!(hTask3 = xTaskGetHandle(<span class="stringliteral">&quot;LED_Task3&quot;</span>)))</div>
<div class="line"><span class="lineno">  158</span>       <a class="code hl_function" href="admin_8c.html#a34a9c5eb09cae80d85d5d13a348ee1e8">error_HaltOS</a>(<span class="stringliteral">&quot;Err:hTask3&quot;</span>);</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    UART_puts((<span class="keywordtype">char</span> *)__func__); UART_puts(<span class="stringliteral">&quot; started\r\n&quot;</span>);</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">while</span>(TRUE)</div>
<div class="line"><span class="lineno">  163</span>    {</div>
<div class="line"><span class="lineno">  164</span>        ulTaskNotifyTake(pdTRUE, portMAX_DELAY); <span class="comment">// wait for notification</span></div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>        xSemaphoreTake(<a class="code hl_variable" href="admin_8c.html#a011b1349f4d8c02977b852c7587f0581">hLED_Sem</a>, portMAX_DELAY); <span class="comment">// wait for mutex</span></div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">for</span> (i=0; i&lt;4; i++) <span class="comment">// voorbeeld hoe je je code zo overdraagbaar mogelijk maakt</span></div>
<div class="line"><span class="lineno">  169</span>        {</div>
<div class="line"><span class="lineno">  170</span>            <span class="keywordflow">if</span>      (i==0)  leds = 1+128; <span class="comment">// zichtbaar: 1. waarde i, 2. welke leds aan gaan</span></div>
<div class="line"><span class="lineno">  171</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i==1)  leds = 2+64;  <span class="comment">// had ook met switch-case gekund, maar dit is korter...</span></div>
<div class="line"><span class="lineno">  172</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (i==2)  leds = 4+32;</div>
<div class="line"><span class="lineno">  173</span>            <span class="keywordflow">else</span>            leds = 8+16;</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>            LED_put(leds);     <span class="comment">// set leds</span></div>
<div class="line"><span class="lineno">  176</span>            osDelay(<a class="code hl_variable" href="ledjes_8c.html#ac0e8ff7c2f49b0988165336ca423dcea">os_delay</a>); <span class="comment">// snelheid bepalen, waarde os_delay kan veranderd worden via user interface</span></div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="admin_8c.html#a952449da34b356e2651de547daf4312c">Uart_debug_out</a> &amp; <a class="code hl_define" href="admin_8h.html#a367617a9804f8aeeb1b5b09d17af0d1a">LEDS_DEBUG_OUT</a>)</div>
<div class="line"><span class="lineno">  179</span>            {</div>
<div class="line"><span class="lineno">  180</span>                UART_puts(<span class="stringliteral">&quot;\r\n\t\t\tM4 led: &quot;</span>); UART_putint(leds);</div>
<div class="line"><span class="lineno">  181</span>            }</div>
<div class="line"><span class="lineno">  182</span>        }</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>        xSemaphoreGive(<a class="code hl_variable" href="admin_8c.html#a011b1349f4d8c02977b852c7587f0581">hLED_Sem</a>); <span class="comment">// free mutex</span></div>
<div class="line"><span class="lineno">  185</span>        osDelay(200);</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>        xTaskNotifyGive(hTask3); <span class="comment">// give the ball back to task 3</span></div>
<div class="line"><span class="lineno">  188</span>    }</div>
<div class="line"><span class="lineno">  189</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Documentatie van variabelen</h2>
<a id="ac0e8ff7c2f49b0988165336ca423dcea" name="ac0e8ff7c2f49b0988165336ca423dcea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0e8ff7c2f49b0988165336ca423dcea">&#9670;&#160;</a></span>os_delay</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int os_delay = 100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>default value 100MSEC, kan veranderd worden via Terminal (user interface) </p>

<p class="definition">De definitie bevindt zich op regel <a class="el" href="ledjes_8c_source.html#l00036">36</a> in het bestand <a class="el" href="ledjes_8c_source.html">ledjes.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Gegenereerd door&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
